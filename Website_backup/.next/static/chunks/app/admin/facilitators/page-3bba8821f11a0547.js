(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6240],{73561:(e,a,l)=>{Promise.resolve().then(l.bind(l,88202))},88202:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>i});var t=l(73365),s=l(1521);let r=[{value:"Attendance Facilitator",label:"Attendance Facilitator"},{value:"Education Facilitator",label:"Education Facilitator"}];function i(){let[e,a]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0),[c,o]=(0,s.useState)(null),[n,d]=(0,s.useState)(""),[m,x]=(0,s.useState)(1),[u,h]=(0,s.useState)(!1),[b,p]=(0,s.useState)(null),[f,g]=(0,s.useState)({name:"",email:"",password:"",role:"Attendance Facilitator"}),[j,N]=(0,s.useState)(null),[y,v]=(0,s.useState)(!1),w=(0,s.useCallback)(async()=>{i(!0);try{let e=await fetch("/api/facilitators");if(!e.ok)throw Error("HTTP error! Status: ".concat(e.status));let l=await e.json();a(Array.isArray(l)?l:[]),o(null)}catch(e){o("Failed to load facilitators")}finally{i(!1)}},[]);function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;p(e),g(e?{name:e.name||"",email:e.email,password:"",role:e.role}:{name:"",email:"",password:"",role:"Attendance Facilitator"}),N(null),h(!0)}function E(){h(!1),p(null),g({name:"",email:"",password:"",role:"Attendance Facilitator"}),N(null)}(0,s.useEffect)(()=>{w()},[w]),(0,s.useEffect)(()=>{x(1)},[e.length]);let k=(0,s.useCallback)(async e=>{e.preventDefault(),v(!0),N(null);try{let e=b?"PUT":"POST",a=b?{...f,id:b._id}:f,l=await fetch("/api/facilitators",{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){let e=await l.json();throw Error(e.error||"Failed to save facilitator")}E(),w()}catch(e){N(e.message)}finally{v(!1)}},[b,f,w]),S=(0,s.useCallback)(async e=>{if(confirm("Are you sure you want to delete this facilitator?")){v(!0);try{if(!(await fetch("/api/facilitators",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Failed to delete facilitator");w()}catch(e){o("Failed to delete facilitator")}finally{v(!1)}}},[w]),F=(0,s.useMemo)(()=>e.filter(e=>[e.name,e.email,e.role].join(" ").toLowerCase().includes(n.toLowerCase())),[e,n]),A=(0,s.useMemo)(()=>F.slice((m-1)*10,10*m),[F,m]),P=Math.ceil(F.length/10);return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col gap-8 p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h1",{className:"text-3xl font-extrabold text-blue-900",children:"Manage Facilitators"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50",onClick:()=>(function(e,a){if(!e.length)return;let l=new Blob([["Name,Email,Role",...e.map(e=>['"'.concat((e.name||"-").replace(/"/g,'""'),'"'),'"'.concat(e.email.replace(/"/g,'""'),'"'),'"'.concat(e.role.replace(/"/g,'""'),'"')].join(","))].join("\n")],{type:"text/csv"}),t=URL.createObjectURL(l),s=document.createElement("a");s.href=t,s.download=a,s.click(),URL.revokeObjectURL(t)})(F,"facilitators.csv"),disabled:0===F.length,"aria-label":"Export facilitators to CSV",children:"Export CSV"}),(0,t.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",onClick:()=>C(),"aria-label":"Add new facilitator",children:"+ Add Facilitator"})]})]}),(0,t.jsxs)("label",{className:"flex flex-col max-w-xs",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Search Facilitators"}),(0,t.jsx)("input",{type:"text",placeholder:"Search facilitators...",className:"p-2 border rounded w-full",value:n,onChange:e=>{d(e.target.value),x(1)},"aria-label":"Search facilitators"})]}),l?(0,t.jsx)("div",{className:"text-gray-500",children:"Loading facilitators..."}):c?(0,t.jsx)("div",{className:"text-red-500",children:c}):(0,t.jsxs)("div",{className:"overflow-x-auto max-h-[600px]",children:[(0,t.jsxs)("table",{className:"min-w-full border-collapse border",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border p-3 text-left",children:"Name"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Email"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Role"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:A.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"border p-3",children:e.name||"-"}),(0,t.jsx)("td",{className:"border p-3",children:e.email}),(0,t.jsx)("td",{className:"border p-3 capitalize",children:e.role}),(0,t.jsxs)("td",{className:"border p-3 flex gap-2",children:[(0,t.jsx)("button",{className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600",onClick:()=>C(e),"aria-label":"Edit ".concat(e.name||"facilitator"),children:"Edit"}),(0,t.jsx)("button",{className:"bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700",onClick:()=>S(e._id),disabled:y,"aria-label":"Delete ".concat(e.name||"facilitator"),children:"Delete"})]})]},e._id))})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-4 justify-center",children:[(0,t.jsx)("button",{className:"px-3 py-1 rounded border bg-gray-100 disabled:opacity-50",onClick:()=>x(e=>Math.max(1,e-1)),disabled:1===m,"aria-label":"Previous page",children:"Prev"}),(0,t.jsxs)("span",{className:"px-2",children:["Page ",m," of ",P]}),(0,t.jsx)("button",{className:"px-3 py-1 rounded border bg-gray-100 disabled:opacity-50",onClick:()=>x(e=>Math.min(P,e+1)),disabled:m===P,"aria-label":"Next page",children:"Next"})]})]}),u&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 w-full max-w-md relative",children:[(0,t.jsx)("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",onClick:E,"aria-label":"Close modal",children:"\xd7"}),(0,t.jsx)("h3",{className:"text-xl font-bold mb-4",children:b?"Edit Facilitator":"Add Facilitator"}),(0,t.jsxs)("form",{onSubmit:k,className:"flex flex-col gap-4",children:[(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Name"}),(0,t.jsx)("input",{type:"text",placeholder:"Name",className:"p-3 border rounded-lg",value:f.name,onChange:e=>g({...f,name:e.target.value}),required:!0,"aria-required":"true"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Email"}),(0,t.jsx)("input",{type:"email",placeholder:"Email",className:"p-3 border rounded-lg",value:f.email,onChange:e=>g({...f,email:e.target.value}),required:!0,disabled:!!b,"aria-required":"true"})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Password"}),(0,t.jsx)("input",{type:"password",placeholder:b?"New Password (leave blank to keep)":"Password",className:"p-3 border rounded-lg",value:f.password,onChange:e=>g({...f,password:e.target.value}),minLength:6*!b,required:!b,"aria-required":!b})]}),(0,t.jsxs)("label",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Role"}),(0,t.jsx)("select",{className:"p-3 border rounded-lg",value:f.role,onChange:e=>g({...f,role:e.target.value}),required:!0,"aria-required":"true",children:r.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),j&&(0,t.jsx)("div",{className:"text-red-500 text-sm",children:j}),(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400",disabled:y,"aria-label":b?"Update facilitator":"Add facilitator",children:y?"Saving...":b?"Update Facilitator":"Add Facilitator"})]})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[2347,4870,7358],()=>a(73561)),_N_E=e.O()}]);