(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1487],{48944:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(73365),r=s(1521),l=s(50627),d=s(59534),c=s.n(d);function n(){let{id:e}=(0,l.useParams)(),[a,s]=(0,r.useState)(null),[d,n]=(0,r.useState)([]),[i,m]=(0,r.useState)([]),[u,o]=(0,r.useState)(!0),[x,h]=(0,r.useState)(null),[b,g]=(0,r.useState)("Semester 1"),[j,p]=(0,r.useState)(!1),[N,f]=(0,r.useState)({subjectId:"",subjectName:"",mark:0,maxMark:100,percentage:0,grade:"",semester:"Semester 1",remarks:""});(0,r.useEffect)(()=>{e&&k()},[e]);let k=async()=>{o(!0);try{let a=await fetch("/api/students/".concat(e));if(!a.ok)throw Error("Failed to fetch student");let t=await a.json();s(t);let r=[{name:"Amharic",grade:t.Grade,academicYear:t.Academic_Year},{name:"English",grade:t.Grade,academicYear:t.Academic_Year},{name:"Mathematics",grade:t.Grade,academicYear:t.Academic_Year},{name:"Science",grade:t.Grade,academicYear:t.Academic_Year}];n(r);let l=[{studentId:e,subjectId:"1",subjectName:"Amharic",mark:85,maxMark:100,percentage:85,grade:"A",academicYear:t.Academic_Year,semester:"Semester 1",date:"2024-12-15"}];m(l),h(null)}catch(e){h("Failed to load data")}finally{o(!1)}},v=(e,a)=>Math.round(e/a*100),y=e=>e>=90?"A+":e>=80?"A":e>=70?"B+":e>=60?"B":e>=50?"C+":e>=40?"C":e>=30?"D":"F",w=(e,a)=>{let s=v(e,a),t=y(s);f(r=>({...r,mark:e,maxMark:a,percentage:s,grade:t}))},S=async()=>{if(!N.subjectId||0===N.mark)return void h("Please fill in all required fields");try{let s={studentId:e,subjectId:N.subjectId,subjectName:N.subjectName,mark:N.mark,maxMark:N.maxMark,percentage:N.percentage,grade:N.grade,academicYear:(null==a?void 0:a.Academic_Year)||"",semester:N.semester,date:new Date().toISOString().split("T")[0],remarks:N.remarks};m(e=>[...e,s]),p(!1),f({subjectId:"",subjectName:"",mark:0,maxMark:100,percentage:0,grade:"",semester:"Semester 1",remarks:""}),h(null)}catch(e){h("Failed to add result")}},_=async e=>{try{m(a=>a.filter(a=>a._id!==e))}catch(e){h("Failed to delete result")}},M=i.filter(e=>e.semester===b);return u?(0,t.jsx)("div",{className:"text-gray-500",children:"Loading student results..."}):x?(0,t.jsx)("div",{className:"text-red-500",children:x}):a?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Student Results"}),(0,t.jsxs)("p",{className:"text-gray-600",children:[a.First_Name," ",a.Father_Name," - ",a.Grade," (",a.Academic_Year,")"]})]}),(0,t.jsx)(c(),{href:"/facilitator/results/",className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"Back to Students"})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Select Semester"}),(0,t.jsx)("div",{className:"flex gap-2",children:["Semester 1","Semester 2","Final"].map(e=>(0,t.jsx)("button",{onClick:()=>g(e),className:"px-4 py-2 rounded-lg ".concat(b===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e},e))})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Add New Result"}),(0,t.jsx)("button",{onClick:()=>p(!j),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:j?"Cancel":"Add Result"})]}),j&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,t.jsxs)("select",{value:N.subjectId,onChange:e=>{let a=d.find(a=>a._id===e.target.value);f(s=>({...s,subjectId:e.target.value,subjectName:(null==a?void 0:a.name)||""}))},className:"w-full p-3 border rounded-lg",children:[(0,t.jsx)("option",{value:"",children:"Select Subject"}),d.map(e=>(0,t.jsx)("option",{value:e._id||e.name,children:e.name},e._id||e.name))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mark"}),(0,t.jsx)("input",{type:"number",min:"0",max:N.maxMark,value:N.mark,onChange:e=>w(parseInt(e.target.value)||0,N.maxMark),className:"w-full p-3 border rounded-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Mark"}),(0,t.jsx)("input",{type:"number",min:"1",value:N.maxMark,onChange:e=>w(N.mark,parseInt(e.target.value)||100),className:"w-full p-3 border rounded-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Percentage"}),(0,t.jsx)("input",{type:"number",value:N.percentage,disabled:!0,className:"w-full p-3 border rounded-lg bg-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),(0,t.jsx)("input",{type:"text",value:N.grade,disabled:!0,className:"w-full p-3 border rounded-lg bg-gray-100"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),(0,t.jsx)("input",{type:"text",value:N.remarks,onChange:e=>f(a=>({...a,remarks:e.target.value})),placeholder:"Optional remarks",className:"w-full p-3 border rounded-lg"})]}),(0,t.jsx)("div",{className:"md:col-span-2 lg:col-span-3",children:(0,t.jsx)("button",{onClick:S,className:"w-full bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700",children:"Save Result"})})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Results for ",b]}),0===M.length?(0,t.jsxs)("p",{className:"text-gray-600",children:["No results found for ",b,"."]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full border-collapse border",children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"border p-3 text-left",children:"Subject"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Mark"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Max Mark"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Percentage"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Grade"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Date"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Remarks"}),(0,t.jsx)("th",{className:"border p-3 text-left",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:M.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"border p-3",children:e.subjectName}),(0,t.jsx)("td",{className:"border p-3",children:e.mark}),(0,t.jsx)("td",{className:"border p-3",children:e.maxMark}),(0,t.jsxs)("td",{className:"border p-3",children:[e.percentage,"%"]}),(0,t.jsx)("td",{className:"border p-3",children:e.grade}),(0,t.jsx)("td",{className:"border p-3",children:e.date}),(0,t.jsx)("td",{className:"border p-3",children:e.remarks||"-"}),(0,t.jsx)("td",{className:"border p-3",children:(0,t.jsx)("button",{onClick:()=>_(e._id||""),className:"text-red-600 hover:text-red-800",children:"Delete"})})]},e._id||"".concat(e.subjectId,"-").concat(e.date)))})]})})]})]}):(0,t.jsx)("div",{className:"text-red-500",children:"Student not found"})}function i(){return(0,t.jsx)(n,{})}},50627:(e,a,s)=>{"use strict";var t=s(47192);s.o(t,"useParams")&&s.d(a,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(a,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(a,{useRouter:function(){return t.useRouter}})},92432:(e,a,s)=>{Promise.resolve().then(s.bind(s,48944))}},e=>{var a=a=>e(e.s=a);e.O(0,[9534,2347,4870,7358],()=>a(92432)),_N_E=e.O()}]);